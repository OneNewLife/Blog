<!DOCTYPE html> <html lang="pt-br"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> 【译】使用 Yum 历史查找已安装或已删除的软件包信息 &bull; Mars Blog </title> <meta name="description" content="Yum 是 RHEL/CentOS 的一个基于 rpm 的交互式高级包管理器，用户可以用它来安装新的软件包、卸载或清除旧的/不需要的软件包。它可以自动运行系统更新，并执行依赖分析，对已安装的或可用的软件包进行查询等等。"> <link rel="stylesheet" href="/css/main.css"> <link rel="canonical" href="https://mars.js.org/how-to-use-yum-history-to-find-out-installed-or-removed-packages-info/"> <link rel="alternate" type="application/rss+xml" title="Mars Blog" href="https://mars.js.org/feed.xml" /> </head> <body class="single"> <main class="main"> <header class="header"> <div class="overlay"> <div style="padding: 0 1em;"> <h1 class="title"> <a href="/">Mars Blog</a> </h1> <nav class="navbar"> <a href="#" class="menu-icon"> <span></span> <span></span> <span></span> </a> <ul class="nav"> <li><a href="/">Home</a></li> <li><a href="/archive.html">Archive</a></li> </ul> </nav> </div> </div> </header> <article class="post container card"> <header class="post-header"> <h1 class="post-title">【译】使用 Yum 历史查找已安装或已删除的软件包信息</h1> <span class="post-meta"> <time class="post-date" datetime="2017-02-23">Feb 23, 2017</time> <span class="post-author">by Mars Wong</span> </span> </header> <div class="post-content"> <p><a href="http://www.tecmint.com/20-linux-yum-yellowdog-updater-modified-commands-for-package-mangement/">Yum</a> 是 RHEL/CentOS 的一个基于 rpm 的交互式高级包管理器，用户可以用它来安装新的软件包、卸载或清除旧的/不需要的软件包。它可以<a href="http://www.tecmint.com/auto-install-security-patches-updates-on-centos-rhel/">自动运行系统更新</a>，并执行依赖分析，对已安装的或可用的软件包进行查询等等。</p> <p>在本文中，我们将解释如何查看 Yum 事务的历史记录，以便于了解有关安装的软件包以及从系统中所卸载/清除软件包的信息。</p> <p><strong>推荐阅读：</strong> <a href="http://www.tecmint.com/20-linux-yum-yellowdog-updater-modified-commands-for-package-mangement/">20 条关于 Linux 软件包管理的 Yum 命令</a></p> <p>以下是一些如何使用 Yum 历史命令的示例。</p> <h3 id="查看完整的-yum-历史">查看完整的 Yum 历史</h3> <p>要查看 Yum 事务完整的历史记录，我们可以运行以下命令，然后将显示：事务 ID、执行特定操作的用户、操作发生的日期和时间、实际操作以及任何错误的附加信息与操作：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># yum history
</code></pre></div></div> <p><a href="http://www.tecmint.com/wp-content/uploads/2017/02/View-Yum-History.png"><img src="http://www.tecmint.com/wp-content/uploads/2017/02/View-Yum-History.png" alt="查看 Yum 历史" /></a></p> <h3 id="使用-yum-查找软件包信息">使用 Yum 查找软件包信息</h3> <p><code class="highlighter-rouge">history</code> 的子命令：<code class="highlighter-rouge">info</code>/<code class="highlighter-rouge">list</code>/<code class="highlighter-rouge">summary</code> 可以将事务 ID 或包名作为参数。此外，<code class="highlighter-rouge">list</code> 子命令可以加上特殊的参数，<code class="highlighter-rouge">all</code> 表示所有的事务。</p> <p>运行以下命令查看先前的历史：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># yum history list all
</code></pre></div></div> <p>并且，你可以使用下面的 <code class="highlighter-rouge">info</code> 命令查看涉及指定软件包的事务详情，例如 <code class="highlighter-rouge">httpd</code>：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># yum history info httpd
</code></pre></div></div> <p><a href="http://www.tecmint.com/wp-content/uploads/2017/02/Yum-Find-Package-Info.png"><img src="http://www.tecmint.com/wp-content/uploads/2017/02/Yum-Find-Package-Info.png" alt="Yum - 查找软件包信息" /></a></p> <p>发出以下命令可以获得包含 <code class="highlighter-rouge">httpd</code> 软件包的事务的摘要：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># yum history summary httpd
</code></pre></div></div> <p><a href="http://www.tecmint.com/wp-content/uploads/2017/02/Yum-Find-Summary-of-Package.png"><img src="http://www.tecmint.com/wp-content/uploads/2017/02/Yum-Find-Summary-of-Package.png" alt="Yum - 查找软件包的摘要" /></a></p> <p>还可以使用事务的 ID 来查找，以下命令会显示 ID 为 <code class="highlighter-rouge">15</code> 的事务的详情。</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># yum history info 15
</code></pre></div></div> <p><a href="http://www.tecmint.com/wp-content/uploads/2017/02/Find-Package-Info-Using-ID.png"><img src="http://www.tecmint.com/wp-content/uploads/2017/02/Find-Package-Info-Using-ID.png" alt="Yum - 使用 ID 查找软件包信息" /></a></p> <h3 id="使用-yum-history-查找软件包事务信息">使用 yum history 查找软件包事务信息</h3> <p>有一些用于打印某个或多个软件包事务详情的子命令。我们可以使用 <code class="highlighter-rouge">package-list</code> 或 <code class="highlighter-rouge">package_info</code> 查看关于 <code class="highlighter-rouge">httpd</code> 的更多信息，例如：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># yum history package-list httpd
或
# yum history package-info httpd
</code></pre></div></div> <p><a href="http://www.tecmint.com/wp-content/uploads/2017/02/Find-Package-Transaction-Info.png"><img src="http://www.tecmint.com/wp-content/uploads/2017/02/Find-Package-Transaction-Info.png" alt="Yum - 查找软件包事务信息" /></a></p> <p>要得到多个软件包的记录，我们可以运行：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># yum history package-list httpd epel-release
或
# yum history packages-list httpd epel-release
</code></pre></div></div> <p><a href="http://www.tecmint.com/wp-content/uploads/2017/02/Find-Multiple-Package-Info.png"><img src="http://www.tecmint.com/wp-content/uploads/2017/02/Find-Multiple-Package-Info.png" alt="Yum - 查找多个软件包的信息" /></a></p> <h3 id="使用-yum-回滚软件包">使用 Yum 回滚软件包</h3> <p>此外，还有一些 <code class="highlighter-rouge">history</code> 的子命令可以让我们撤销/重做/回滚事务。</p> <ol> <li><code class="highlighter-rouge">undo</code> - 会撤销一个指定的事务。</li> <li><code class="highlighter-rouge">redo</code> - 重复一次指定的事务。</li> <li><code class="highlighter-rouge">rollback</code> - 撤销指定事务之后的所有事务。</li> </ol> <p>它们采用单个事务 id 或关键字 <code class="highlighter-rouge">last</code> 和从最后一个事务开始的偏移量。</p> <p>例如，假设我们已经做了 60 个事务，<code class="highlighter-rouge">last</code> 是指事务 60，<code class="highlighter-rouge">last-4</code> 指向事务 56。</p> <p><strong>推荐阅读：</strong> <a href="http://www.tecmint.com/linux-yum-package-management-with-yum-utils/">怎样使用 <code class="highlighter-rouge">yum-utils</code> 来维护以及加速 Yum</a></p> <p>以上子命令是如下工作的：如果我们有 5 个事务——V，W，X，Y 和 Z，其中分别是安装各个软件包的。</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># yum history undo 2    #将删除软件包 W
# yum history redo 2    #将重新安装软件包 W
# yum history rollback 2    #将删除软件包 X、 Y 和 Z
</code></pre></div></div> <p>在下面的示例中，事务 2 是一个更新操作，如下所示，以下 <code class="highlighter-rouge">redo</code> 命令将重复事务 2 直到所有软件包到更新到当前时间的最新版本：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># yum history | grep -w "2"
</code></pre></div></div> <p><a href="http://www.tecmint.com/wp-content/uploads/2017/02/Find-Yum-Package-Transaction-ID.png"><img src="http://www.tecmint.com/wp-content/uploads/2017/02/Find-Yum-Package-Transaction-ID.png" alt="Yum - 查找软件包事务的 ID" /></a></p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># yum history redo 2
</code></pre></div></div> <p><a href="http://www.tecmint.com/wp-content/uploads/2017/02/Yum-Redo-Package-Update.png"><img src="http://www.tecmint.com/wp-content/uploads/2017/02/Yum-Redo-Package-Update.png" alt="用 Yum 重新更新软件包" /></a></p> <p><code class="highlighter-rouge">redo</code> 子命令同样可以在我们指定事务之前加上一些可选的参数：</p> <ol> <li><code class="highlighter-rouge">force-reinstall</code> - 重新安装所有在此事务中安装的软件包（通过 <code class="highlighter-rouge">yum install</code>、<code class="highlighter-rouge">upgrade</code> 或 <code class="highlighter-rouge">downgrade</code>）。</li> <li><code class="highlighter-rouge">force-remove</code> - 移除所有已经更新或回滚的软件包。</li> </ol> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># yum history redo force-reinstall 16
</code></pre></div></div> <p><a href="http://www.tecmint.com/wp-content/uploads/2017/02/Yum-Force-Install-Package.png"><img src="http://www.tecmint.com/wp-content/uploads/2017/02/Yum-Force-Install-Package.png" alt="Yum - 强制安装软件包" /></a></p> <h3 id="查找-yum-历史数据库和来源信息">查找 Yum 历史数据库和来源信息</h3> <p>这些子命令为我们提供有关历史记录数据库和其它信息来源的信息：</p> <ol> <li><code class="highlighter-rouge">addon-info</code> - 提供更多的信息来源。</li> <li><code class="highlighter-rouge">stats</code> - 显示当前历史数据库的统计信息。</li> <li><code class="highlighter-rouge">sync</code> - 使我们能够更改为所有已安装软件包存储的 <code class="highlighter-rouge">rpmdb</code>/<code class="highlighter-rouge">yumdb</code> 数据。</li> </ol> <p>看一下以下的命令的子命令实际上是怎样工作的：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># yum history addon-info
# yum history stats
# yum history sync
</code></pre></div></div> <p>使用 <code class="highlighter-rouge">new</code> 子命令设置新的历史文件：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># yum history new
</code></pre></div></div> <p>我们可以在 yum 手册页找到关于 Yum <code class="highlighter-rouge">history</code> 命令和其它几个命令的完整信息：</p> <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># man yum
</code></pre></div></div> <p>就是这么多了。在本篇指南中，我们介绍了各种 Yum <code class="highlighter-rouge">history</code> 命令，以查看 Yum 事务的详细信息。</p> <h3 id="reference">Reference</h3> <ul> <li><a href="http://www.tecmint.com/view-yum-history-to-find-packages-info/">How to use Yum History to find out Installed or Removed Packages Info</a></li> <li><a href="http://www.tecmint.com/yum-lock-disable-blacklist-certain-package-update-version/">4 个使用 Yum 禁用/锁定某些软件包更新的方法</a></li> </ul> <aside class="share"> <span>Share this: </span> <a href="http://twitter.com/share?text=【译】使用 Yum 历史查找已安装或已删除的软件包信息&amp;url=https://mars.js.org/how-to-use-yum-history-to-find-out-installed-or-removed-packages-info/&amp;hashtags=web,dev,blog,soudev&amp;via=nandomoreirame" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;"> <i class="fa fa-twitter-square"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?u=https://mars.js.org/how-to-use-yum-history-to-find-out-installed-or-removed-packages-info/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;"> <i class="fa fa-facebook-square"></i> </a> </aside> </div> </article> <footer class="footer t-center"> <div class="container"> <div class="social-icons"> <ul class="text-left"> <li><a href="https://www.facebook.com/maaarswong" target="_blank"><i class="fa fa-facebook"></i></a></li> <li><a href="https://twitter.com/maaarswong" target="_blank"><i class="fa fa-twitter"></i></a></li> </ul> </div> <small> <a href=https://github.com/marswong target="_blank">Mars Wong</a> &copy; 2015 - 2020 All rights reserved. </small> <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"> <img alt="Creative Commons License" style="border-width: 0;margin: .5em auto;" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /> </a> </div> </footer> </main> <script src="/js/typed.min.js"></script> <script> window.onload = function () { new Typed('#motto', { strings: ['起风了，唯有努力生存'], contentType: 'html', typeSpeed: 100, showCursor: false }); } </script> </body> </html></body></html>
